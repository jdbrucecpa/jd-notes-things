  Test 1: Routing Preview Display

  Steps:
  1. Click on a meeting with a transcript
  2. Click "Generate Summary" button to open the template modal
  3. Look at the "Save Location" section

  Expected:
  - Shows the auto-determined save path with colored icon
  - Shows reason text explaining why this destination was chosen
  - "Change" button visible in the header

  ---
  Test 2: Destination Picker Opens

  Steps:
  1. In the template modal, click the "Change" button

  Expected:
  - Dropdown appears below the routing preview
  - Options grouped by "Clients", "Industry", "Other"
  - All configured destinations visible
  - "Apply" and "Cancel" buttons visible

  ---
  Test 3: Cancel Destination Change

  Steps:
  1. Click "Change" to open picker
  2. Select a different destination
  3. Click "Cancel"

  Expected:
  - Picker closes
  - Original routing preview remains unchanged
  - No "Manual" badge appears

  ---
  Test 4: Apply Destination Override

  Steps:
  1. Click "Change" to open picker
  2. Select a different client/industry destination
  3. Click "Apply"

  Expected:
  - Picker closes
  - Routing preview updates to show new destination
  - "Manual" badge appears on the routing preview
  - Path and icon change to match selected destination

  ---
  Test 5: Create Rule Prompt Appears

  Steps:
  1. Open template modal for a meeting with participants from unmapped domains
  2. Click "Change" and select a client destination
  3. Click "Apply"

  Expected:
  - "Create Rule" prompt appears below routing preview
  - Shows message about creating routing rule
  - Domain chips appear for unmapped participant domains
  - Domains pre-selected with checkboxes

  ---
  Test 6: Create Rule Prompt NOT Shown (Internal/Unfiled)

  Steps:
  1. Click "Change" and select "Internal" or "Unfiled"
  2. Click "Apply"

  Expected:
  - NO "Create Rule" prompt appears
  - Only the override preview is shown

  ---
  Test 7: Create Rule Prompt NOT Shown (No New Domains)

  Steps:
  1. Use a meeting where all participant domains are already mapped
  2. Click "Change", select a destination, click "Apply"

  Expected:
  - NO "Create Rule" prompt appears (no new domains to add)

  ---
  Test 8: Deselect Domains

  Steps:
  1. When "Create Rule" prompt appears with domain chips
  2. Uncheck one or more domains
  3. Check "Create Rule" button state

  Expected:
  - Unchecked chips lose blue highlight
  - If all domains unchecked, "Create Rule" button becomes disabled

  ---
  Test 9: Dismiss Rule Prompt

  Steps:
  1. When "Create Rule" prompt appears
  2. Click "Dismiss"

  Expected:
  - Prompt disappears
  - Override remains applied
  - Can still generate summaries

  ---
  Test 10: Create Routing Rule

  Steps:
  1. When "Create Rule" prompt appears
  2. Keep desired domains selected
  3. Click "Create Rule"

  Expected:
  - Button shows "Creating..." briefly
  - Toast message: "Added X domain(s) to [Organization]"
  - Prompt disappears
  - Check %APPDATA%/jd-notes-things-dev/config/routing.yaml - domains should be added

  ---
  Test 11: Override Persists Through Generation

  Steps:
  1. Apply a manual override (different from auto-routed destination)
  2. Select templates and click "Generate Summaries"
  3. Check where files are saved

  Expected:
  - Files saved to the OVERRIDDEN destination, not the auto-detected one
  - Console shows: [ObsidianExport] CS-4.4: Using routing override: [path] (client)

  ---
  Test 12: Override Resets on Modal Close

  Steps:
  1. Apply a manual override
  2. Click "Cancel" or close the modal
  3. Re-open the template modal for the same meeting

  Expected:
  - Routing preview shows original auto-detected destination
  - No "Manual" badge
  - No "Create Rule" prompt

  ---
  Test 13: Verify Rule Was Created

  Steps:
  1. After creating a rule in Test 10
  2. Open a NEW meeting with a participant from the domain you just added
  3. Open template modal

  Expected:
  - Auto-routing should now detect the domain and route to the correct destination

  ---
  Quick Smoke Test Checklist

  | Test                               | Pass/Fail |
  |------------------------------------|-----------|
  | Change button visible              |           |
  | Picker opens with all destinations |           |
  | Cancel works                       |           |
  | Apply shows Manual badge           |           |
  | Create Rule prompt for new domains |           |
  | Create Rule adds to config         |           |
  | Override used during export        |           |

  ---
  Let me know which tests pass/fail and I'll fix any issues!



